this.TextMetrics=function(){"use strict";function i(){var b=localStorage.getItem(a);return b?JSON.parse(b):{}}function j(){c&&(localStorage.setItem(a,JSON.stringify(b)),c=!1)}function k(){var a=document.createElement("canvas");a.width=e.width,a.height=e.height;var b=a.getContext("2d");return b.textBaseline="top",b}function l(){var a=document.createElement("div");a.style.position="absolute",a.style.visibility="hidden";var b=document.createElement("span");return a.appendChild(b),document.body.appendChild(a),b}function m(a){var c=b[a];return c||(c={},b[a]=c),c}function n(a,b,e,f){if(!f)return p(a,b,e);var g=f[a];return g||(g=p(a,b,d),f[a]=g,c=!0),{top:Math.floor(g.top*(e/d)),bottom:Math.floor(g.bottom*(e/d))}}function o(a){return" "===a||"	"===a||"\n"===a||"\f"===a||"\r"===a}function p(a,b,c){f.clearRect(0,0,e.width,e.height),f.font=c+"px "+b,f.fillText(a,0,0);for(var d=f.measureText(a).width,g=f.getImageData(0,0,d,e.height),h=g.data,i=0,j=0;j<h.length;j+=4)if(0!==h[j+3]){i=Math.floor(j/4/g.width);break}for(var k=0,j=h.length-4;j>=0;j-=4)if(0!==h[j+3]){k=Math.floor(j/4/g.width);break}return{top:i,bottom:k}}function q(a,b,c){return g.textContent=a,g.style.fontFamily=b,g.style.fontSize=c+"px",g.offsetHeight}var a="__TextMetrics_cache__",b=i(),c=!1,d=100,e={width:500,height:500},f=k(),g=l(),h={};return h.measureHeight=function(a,b,c,e){e=e||{},e.cache=void 0!==e.cache?e.cache:!0;var g,f={bottom:0,top:1e4};if(e.cache){g=m(b);var h=g.boxHeight;h||(h=q(a,b,d),g.boxHeight=h),f.box=Math.floor(h*(c/d))}else f.box=q(a,b,c);for(var i=!0,k=0;k<a.length;k++){var l=a.charAt(k);if(!o(l)){i=!1;var p=n(l,b,c,g);f.top=Math.min(f.top,p.top),f.bottom=Math.max(f.bottom,p.bottom)}}return e.cache&&j(),i&&(f.top=0,f.bottom=f.box),f},h.fitHeight=function(a,b,c,e){var f=d,g=h.measureHeight(a,c,f,e),i=g.bottom-g.top;return{fontSize:Math.floor(f*(b/i)),marginTop:Math.floor(-g.top*(b/i))}},h.measureWidth=function(a,b,c){return f.font=c+"px "+b,{box:f.measureText(a).width}},h}();